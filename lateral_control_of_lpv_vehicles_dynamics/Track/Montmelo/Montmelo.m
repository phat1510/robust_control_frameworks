Coord = [41.56977149042216, 2.2610085554001316
41.56915985989898, 2.2604975951331587
41.568359153254626, 2.25980345169676
41.56727908718021, 2.258896327326605
41.56673133142587, 2.2584608230759082
41.56595018781376, 2.2577943400886005
41.56554241727891, 2.2574725896968166
41.565164207295346, 2.257132269255227
41.56486171279182, 2.256879515593584
41.564737677993996, 2.2567577207625638
41.56465498799699, 2.2565964553441193
41.56463895625053, 2.2562885850768186
41.564735990444575, 2.256026951736109
41.564856650154155, 2.255764190630238
41.56489715126424, 2.2554743640416066
41.564874369392236, 2.2552702449033286
41.56466933218906, 2.2548247915861714
41.56439004177655, 2.2543376122308185
41.56421751224624, 2.253817296905009
41.56419142302621, 2.2534391054082312
41.56423882269426, 2.2531434056696984
41.56432989644565, 2.252822197365407
41.564791472367276, 2.2522857555890377
41.565210901551374, 2.2521516451029022
41.56538950647221, 2.2521462353995187
41.56561226664362, 2.2521623739425536
41.565931632386715, 2.2522503920521864
41.566174173568335, 2.2523528107731647
41.56650328822991, 2.2525968917927224
41.56667186896909, 2.25273369248633
41.567065197888574, 2.2530636042090064
41.56744447706954, 2.253385469274828
41.567839808041334, 2.25370733438921
41.56818821978651, 2.2540138490396635
41.56804371332207, 2.253890418208712
41.56837386963705, 2.2542234249886484
41.568424037952454, 2.254513103547888
41.5684059773634, 2.2548161931515365
41.56823540488443, 2.2551166005463035
41.56766348210963, 2.2553821392256057
41.56741496882125, 2.2553319009824775
41.56716200387858, 2.25519474380137
41.5658255688494, 2.254084727510793
41.56563942035205, 2.253979467348548
41.56550479464634, 2.254012673024579
41.565405540710564, 2.254084727510793
41.56530053324923, 2.2544579226314805
41.56538406192591, 2.25473861645759
41.56564161606006, 2.2555094334813903
41.565882845206765, 2.25621863821475
41.56605677802089, 2.2565664329622006
41.56634821369126, 2.2569650284561242
41.56680281213009, 2.2573734520609077
41.56717393620304, 2.257685901124496
41.56738394486571, 2.2577847818829686
41.56751147927872, 2.257759422569031
41.567641681836896, 2.2576603835094065
41.56790419067727, 2.2571659796955252
41.568095105513606, 2.2569554593710355
41.56960808566598, 2.2560655325215206
41.56987058650365, 2.25597622087282
41.5700543364595, 2.255979410582459
41.57038984994326, 2.256109207724592
41.5705506973404, 2.25632389838617
41.57066113743711, 2.2565428889290122
41.572766168676836, 2.2620575393983087
41.572923663984646, 2.262288925617145
41.57307122680947, 2.262343927264801
41.57322588363044, 2.262304098494934
41.57337202689165, 2.262161852888265
41.57350256234053, 2.2618356362969725
41.57355789794326, 2.261334931711351
41.57340891737425, 2.2606806019206767
41.57327696286503, 2.2604359394331786
41.57296764909741, 2.259950407762417
41.572881097729244, 2.2596716063349613
41.572923663988966, 2.2592486627311343
41.57304555569159, 2.259033405308225
41.57320006280826, 2.2589060003567343
41.57344887868485, 2.258889907104575
41.573693680462554, 2.259014629817581
41.57459974299793, 2.2604603554860785
41.574703457883956, 2.260727520273102
41.5747579982441, 2.2608636238092856
41.57477274076846, 2.2610360821070095
41.57475472227132, 2.2612217230969613
41.57465541025821, 2.2615554034048944
41.57388059303402, 2.2631744138199608
41.573700050484824, 2.263449580016223
41.573386208984594, 2.263659337780758
41.57310442525407, 2.263684147835125
41.57286144908219, 2.2635894185221095
41.57264546948682, 2.2634360472355177];
%41.569775723658736, 2.2610141026435477];

d2r = pi/180;
Coord = Coord*d2r;


%% Translation x y coordinates


lat1 = 43.5;
clat1 = cos(lat1*d2r);
R = 6371*1000;

Lat0 = Coord(1,1);
Long0 = Coord(1,2);
Lat = Coord(2:end,1);
Long = Coord(2:end,2);

x = R*(Long-Long0)*clat1;
y = R*(Lat-Lat0);

X = [0;x];
Y = [0;y];
plot(X,Y,'o')
axis equal
%% Spline Sections
dx = 0.01;

%section 1
x = X(1:25);
y = Y(1:25);
xs1 = flip(x(end):dx:x(1));
s1 = pchip(x,y,xs1);

%section 2
x = X(25:40);
y = Y(25:40);
xs2 = x(1):dx:x(end);
s2 = pchip(x,y,xs2);

%section 3
x = X(40:44);
y = Y(40:44);
xs3 = flip(x(end):dx:x(1));
s3 = pchip(x,y,xs3);

%section 4
x = X(44:55);
y = Y(44:55);
xs4 = x(1):dx:x(end);
s4 = pchip(x,y,xs4);

%section 5
x = X(55:61);
y = Y(55:61);
xs5 = flip(x(end):dx:x(1));
s5 = pchip(x,y,xs5);

%section 6
x = X(61:68);
y = Y(61:68);
xs6 = x(1):dx:x(end);
s6 = pchip(x,y,xs6);

%section 7
x = X(68:80);
y = Y(68:80);
xs7 = flip(x(end):dx:x(1));
s7 = pchip(x,y,xs7);

%section 8
x = X(80:91);
y = Y(80:91);
xs8 = x(1):dx:x(end);
s8 = pchip(x,y,xs8);

%section 9
x = [X(91:end);0];
y = [Y(91:end);0];
xs9 = flip(x(end):dx:x(1));
s9 = pchip(x,y,xs9);


xs = [xs1,xs2(2:end),xs3(2:end),xs4(2:end),xs5(2:end),xs6(2:end),xs7(2:end),xs8(2:end),xs9(2:end-1)];
s = [s1,s2(2:end),s3(2:end),s4(2:end),s5(2:end),s6(2:end),s7(2:end),s8(2:end),s9(2:end-1)];
hold on
plot(xs,s)
axis equal



%%
Track.X = xs;
Track.Y = s;
